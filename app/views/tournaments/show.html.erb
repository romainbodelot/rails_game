<div class="page-header">
  <h1><%= @tournament.title %></h1>
</div>

<p class="lead"><%= @tournament.address %></p>
<p class="lead"><%= @tournament.date %></p>

<% @tournament.games.uniq.each do |game| %>

  <%= link_to game.name, game_path(game) %>
<br/>
<%= link_to "sub", sub_list_path(:player_id => current_player.id, :tournament_id => @tournament.id, :game_id => game.id) %>
  <%= a = List.find_by_sql("SELECT player_id FROM lists WHERE game_id = #{game.id} AND player_id IS NOT NULL AND tournament_id = #{@tournament.id}").size %>
  <%= "/ #{@tournament.max_player} players" %>
<br/>
  <% if a == @tournament.max_player %>
  <%= link_to "generated match", generate_match_path(:game_id => game.id, :tournament_id => @tournament.id) %>
  <% end %>
  <br/>
  <% id_list = List.connection.select_value("SELECT id FROM lists WHERE game_id = #{game.id} AND player_id IS NOT NULL AND tournament_id = #{@tournament.id}") %>

  <% id_match = Match.connection.select_values("SELECT id FROM matches WHERE winner IS NOT NULL AND list_id = #{id_list}") %>
  match jou√©
  <% id_match.each do |match| %>
  <%= match %>
  <% end %>
<% end %>

<p class="lead">Distance to travel :
  <%= Geocoder::Calculations.distance_between([@tournament.latitude,@tournament.longitude], [current_player.latitude,current_player.longitude]).round %>
  miles</p>

<a class="pull-right" href="<%= edit_tournament_path %>">
  <button type="button" class="btn btn-sm btn-default"><%= fa_icon "edit 2x" %></button>
</a>
<a class="pull-right" href="<%= tournaments_path %>">
  <button type="button" class="btn btn-sm btn-default"><%= fa_icon "reply-all 2x" %></button>
</a>
<%= link_to tournament_path(@tournament), :confirm => 'Are you sure?', :method => :delete do %>
<%= content_tag :button, "", :class => "btn btn-sm btn-default pull-right fa fa-minus fa-2x" %>
<% end %>
